\section{Theory}
\label{sec:theory}

\subsection{Wave analysis}
\label{sec:waves}
Waves are solutions of the wave equation (see eq. \ref{eq:wave}), and have certain properties such as the phase velocity
	\begin{equation}
	\label{eq:phase}
		v_p = \frac{\lambda}{T} = \frac{\omega}{k},
	\end{equation}
where $\lambda$ is the wavelength, $T$ the period, $\omega$ the angular frequency and $k$ the wavenumber.
We found the phase velocity of a variety of waves graphically by studying Hovm√∂ller diagrams \citep{hovmoller}.

\subsection{Rossby wave equation}
\label{sec:wave}
Rossby waves are low frequency waves induced by the meridional
variation of the Coriolis parameter $f$. This parameter depends on the rotation of the Earth $\Omega$ and the latitude $\varphi$, and is given by 
\begin{equation}
	f = \Omega \sin{\varphi}.
\end{equation} 
An approximation where $f$ is set to vary linear in space is called the $\beta$-plane approximation, and can be written as
\begin{equation}\label{beta-plane}
	f = f_0 + \beta y,
\end{equation} 
where $\beta = \left.\frac{df}{dy}\right|_{\varphi_0} = \frac{2\Omega}{a} \cos{\varphi_0}$, $a$ being the radius of the Earth. Combining the $\beta$-plane approximation with the shallow water vorticity equation, you get the quasi-geostrophic vorticity equation. This can be linearised, and by assuming a constant mean flow without bottom topography, you get the barotropic Rossby wave equation:
\begin{equation}\label{eq:rossby full}
	\left(\partial_t + U\partial_x \right) \nabla_H \psi + \beta \partial_x \psi = 0.
\end{equation}
Here, $\psi$ is the stream function describing the velocity perturbation, $\partial_x$ denotes $\frac{\partial}{\partial x}$, $\nabla_H$ is the horizontal divergence $\partial x + \partial y$ and $U$ is the mean velocity. In this report, we will assume no mean velocity, i.e. $U=0$, in which case equation (\ref{eq:rossby full}) simplifies to 
\begin{equation}\label{eq:rossby}
	\partial_t \nabla_H \psi + \beta \partial_x \psi = 0.
\end{equation}

Two forms of boundaries will be examined in this report, that is periodic and constant boundaries. The first case can be used to describe an atmosphere that wraps around the earth, where the stream function is equal at the end-points. The latter case, where the stream function has a constant value at the boundaries, can be used to describe an ocean basin.  

A possible solution to (\ref{eq:rossby}) in one dimension with periodic boundaries, where $x \in \left[0,L \right] $, is given by 
\begin{equation}\label{eq:periodic sol}
	\psi = A\cos{\left(kx-\omega t\right)},
\end{equation}
where $k=\frac{2n\pi}{L}$ and $\omega = - \frac{\beta L}{2n\pi}$. The phase speed $c$ can be calculated through the dispersion relation, given by
\begin{equation}
	c = \frac{\omega L}{2n\pi}=-\beta \left(\frac{L}{2n\pi}\right)^2.
\end{equation}
Since $\beta$ is positive for all latitudes, the phase speed will be negative, implying that Rossby waves travels from east to west in a bounded domain. 

The same problem, but with constant boundaries equal to zero, has the possible solution 
\begin{equation}\label{eq:bounded sol}
	\psi = A\sin\left(\frac{\pi n}{L}x\right)\cos\left(kx-\omega t\right),
\end{equation}
with $k = \frac{L}{\pi n}$ and $\omega = - \frac{\beta}{2k}$. Here, the phase speed is given by 
\begin{equation}
	c = \frac{\omega L}{2n\pi} = - \frac{\beta}{4}
\end{equation}
Again, the phase speed is negative. Equation (\ref{eq:bounded sol}) describes a cosine wave where the amplitude is dependent on the position, following a sine curve with zeros at the boundaries.

\subsubsection{Differential equations}
The forward difference is of first order, meaning that the error is proportional to $\Delta t$. The centred difference, on the other hand, is of second order, with an error proportional to $\Delta t^2$ for the time derivative and $\Delta x^2$ for the spatial derivative.     

\subsection{Discretisation and algorithm}
\label{sec:algo}
Scaling eq. \ref{eq:rossby}, we essentially wanted to solve two equations
	\begin{equation}
	\label{eq:betaplane}
		\partial_t \zeta + \partial_x \psi = 0
	\end{equation}
	\begin{equation}
		\label{eq:poisson}
		\partial_{xx}\psi = \zeta,
	\end{equation}
where the latter is Poisson's equation. To discretise, we use the following schemes:
	\begin{equation}
	\label{eq:explicit}
	\partial_q f \approx \frac{f_{q+1} - f_q}{\Delta q},
	\end{equation}

	\begin{equation}
	\label{eq:implicit}
		\partial_q f \approx \frac{f_{q+1} - f_{q-1}}{2\Delta q},
	\end{equation}
	
	\begin{equation}
	\label{eq:doublederivative}
		\partial_{qq} f \approx \frac{f_{q+1} - 2f_q + f_{q-1}}{\qty(\Delta q)^2},
	\end{equation}
where $f$ is arbitrary and $q$ a general coordinate. Here eq. \ref{eq:explicit} is the explicit forward scheme, and eq. \ref{eq:implicit} the implicit centered scheme. Letting $t^n = n\Delta t$ and $x_j = j\Delta x$, eq. \ref{eq:betaplane} becomes
	\begin{equation}
	\label{eq:explicitscheme}
		\zeta^{n+1}_j = \zeta^n_j - \frac{\Delta t}{2 \Delta x}\qty(\psi^n_{j+1} - \psi^n_{j-1})
	\end{equation}
in the explicit scheme, and
	\begin{equation}
	\label{eq:implicitscheme}
		\zeta^{n+1}_j = \zeta^{n-1}_j - \frac{\Delta t}{\Delta x}\qty(\psi^n_{j+1} - \psi^n_{j-1})
	\end{equation}
in the implicit scheme. For Poisson's equation, we simply have
	\begin{equation}
	\label{eq:poissondiscret}
	\frac{\psi^{n+1}_{j+1} - 2\psi^{n+1}_j + \psi^{n+1}_{j-1}}{\qty(\Delta x)^2} = \zeta^{n+1}_j.
	\end{equation}
Our general algorithm is then Algorithm \ref{algo:1drossby}.
	\begin{algorithm}[htbp]
		\label{algo:1drossby}
		\caption{Algorithm for solving the 1+1 dimensional Rossby wave equation. Here T is a final time, and X a upper spatial bound.}
		\SetAlgoLined
		\BlankLine
		\BlankLine
		initialise wave\;
		\For{$n=0, 1,\ldots,\,$ T}{
			\For{$j=0, 1,\ldots,\,$X}{
				solve for $\zeta^{n+1}_j$\;
				solve for $\psi^{n+1}_j$\;
			}
		}
		\BlankLine
		\BlankLine
	\end{algorithm}
What remains now is to determine how to solve the equations for closed and periodic boundary conditions.
In the case of closed boundaries we had the Dirichlet boundary conditions, and could use gaussian elimination as outlined in one of our earlier papers \citep{sjurkal}. As for the periodic domain, we found that the resulting matrix form of the Laplacian would be singular. This prompted us to implement Jacobi's method, as described by \citet{compphys}.

Up until this point we had only considered the $1 + 1$ dimensional Rossby wave, however, expanding to $2 + 1$ dimensions was rather straightforward as we could employ the same Jacobi's method as for the one-dimensional case. Therefore, we won't go into anymore detail.


\subsection{Implementation}
\label{sec:implement}
We implemented our algorithms in C++ using the armadillo and LAPACK libraries to handle matrix operations. To analyse data and produce figures, we used python 3.6 with a standard set of modules: matplotlib, numpy and seaborn.

